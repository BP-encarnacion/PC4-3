---
title: "pc4-3"
format: html
editor: visual
---

## 

**Importación y cargado de datos**

```{r}
install.packages("car")
install.packages("here")
install.packages("rio")
install.packages("ggtplot2")
install.packages("MICE")
install.packages("VIM")
```

```{r}
library(car)
library(here)
library(rio)
library(ggplot2)
library(mice)
library(VIM)
```

**Ejemplos de análisis univariado y multivariado en una regresión logística**
El dataset para este ejercicio
Para ilustrar el proceso de análisis multivariado en un modelo de regresión logística,
se empleará el dataset almac_sangre.csv .
Este conjunto de datos incluye información 316 pacientes de. Las variables
**Grupo_edad_GR, Raza_afroamericana, Historia_familiar, Volumen_tumoral.**
**Cargando los datos
*El análisis univariado (funcion IMPORT/ HEAD)***

```{r}
almac_sangre <- import("almac_sangre.csv")
```

```{r}
head(almac_sangre)
```

Reporte del análisis univariado y multivariado
Modelo final de regresión logística.

**Tabla para los resultados de la regresión univariado (no ajustado)**

```{r}
tabla_reg_log_univ <- almac_sangre_4 |>
  tbl_uvregression(
    include = c(grupo_edad_gr, edad_de_px
, gleason_biopsia, raza_afroamericana, historia_familiar,
                volumen_prostata, confinamiento_organo),
    y = desenlace,
    method = glm,
    method.args = list(family = binomial),
    exponentiate = TRUE,
    conf.int = TRUE,
    hide_n = TRUE,
    add_estimate_to_reference_rows = FALSE,
    pvalue_fun = ~ style_pvalue(.x, digits = 3),
    estimate_fun = ~ style_number(.x, digits = 2),
    label = list(
      grupo_edad_gr ~ "Edad (etapa)",
      edad_de_px ~ "años",
      gleason_biopsia ~ "Gleason",
      raza_afroamericana ~ "Raza",
      historia_familiar ~ "confirmacion (Si,No)",
      volumen_prostata ~ "centrimetros cubicos(cc)",
      confinamiento_organo ~ "confirmacion (Si,No)")
  ) |>
  bold_labels() |>
  bold_p(t = 0.05) |>
  modify_header(estimate = "**OR no ajustado**", p.value = "**Valor P**")
```

Visualización comando (VIM)

```{r}
aggr_plot <- aggr(almac_sangre,col = c("navyblue", "red"),  numbers = TRUE, sortVars = TRUE,labels = names(almac_sangre), 
cex.axis = .7,  gap = 3, ylab = c("Histogram of missing data", "Pattern"))
```

**Variables de almac_sangre.csv (comando NAMES)**

```{r}
names(almac_sangre)
```
